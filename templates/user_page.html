{% extends "layout2.html" %} {% block title %}UserPage{% endblock %}
{%block navbarsignup %}
<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
<ul class="nav navbar-nav navbar-right">

	<li class="dropdown"><a href="#" class="dropdown-toggle"
		data-toggle="dropdown" role="button" aria-haspopup="true"
		aria-expanded="false"><span class="glyphicon glyphicon-user"></span>
			{{ user_name }}</a>
		<ul class="dropdown-menu">
			<li><a href="#"><span class="glyphicon glyphicon-user">
						Profile</a></li>
			<li><a href="#"><span class="glyphicon glyphicon-envelope">
						Inbox</a></li>
			<li><a href="#"><span class="glyphicon glyphicon-cog">
						Settings</a></li>
			<li role="separator" class="divider"></li>
			<li><a href="{{url_for('register.log_out')}}"><span class="glyphicon glyphicon-log-out" >
						Log-out</a></li>
		</ul></li>

</ul>

{% endblock %} {% block content %}
        <div id="map"> style="width: 100%"</div>
<div class="row centered-form">
	<div class="centered modal fade" id="squareSigninModal" tabindex="-1"
		role="dialog" aria-labelledby="modalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal">
						<span aria-hidden="true">Ã—</span><span class="sr-only">Close</span>
					</button>
					<h3 class="modal-title" id="lineModalLabel">Add New Location</h3>
				</div>
				<div class="modal-body">

					<!-- content goes here -->
					<form role="form" data-toggle="validator">
						<div class="form-group">
							<label for="locationLabel">Label</label> 
							<input required class="form-control"id="label" name="locationLabel"
								placeholder="label" requiered>
						</div>
						<div class="form-group">
							<label for="locationInfo">Info</label>
							 <textarea required class="form-control" id="info" name="locationInfo"
								placeholder="info" > </textarea>
						</div>
						
						<button  id= "share" type="submit" class="btn btn-primary">Share</button>
					</form>

				</div>

			</div>
		</div>
	</div>
</div>
 <script>src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB9fvYCoVIga4fQ-mHNtf4dv4jHbCjCJKw"></script>
                
         
                 
<div class="container">

	<div class="col-md-8 col-lg-offset-2">

		<div class="panel panel-default">
			<div class="panel-heading">
				<h1>User Profile</h1>
			</div>
			<div class="panel-body">

				<div class="box box-info">

					<div class="box-body">
						<div class="col-sm-6">
							<div align="center">
								<img alt="User Pic"
									src="https://x1.xingassets.com/assets/frontend_minified/img/users/nobody_m.original.jpg"
									id="profile-image1" class="img-circle img-responsive"> <input
									id="profile-image-upload" class="hidden" type="file">
								<div style="color: #999;">click here to change profile
									image</div>
								<!--Upload Image Js And Css-->

							</div>

							<br>

							<!-- /input-group -->
						</div>
						<div class="col-sm-6">
							<h1 style="color: #00b1b1;">{{ first_name }} {{last_name}}</h1>
							</span> <span><h4>{{user_name}}</h4></span>
						</div>
						<div class="clearfix"></div>
						<hr style="margin: 5px 0 5px 0;">


						<div class="col-sm-5 col-xs-6 tital "><h4>First Name:</h4></div>
						<div class="col-sm-7 col-xs-6 "><h4>{{ first_name }}</h4></div>
						<div class="clearfix"></div>
						<div class="bot-border"></div>


						<div class="col-sm-5 col-xs-6 tital "><h4>Last Name:</h4></div>
						<div class="col-sm-7"><span><h4>{{last_name}}</h4></span></div>
						<div class="clearfix"></div>
						<div class="bot-border"></div>

						<div class="col-sm-5 col-xs-6 tital "><h4>Date Of Joining:</h4></div>
						<div class="col-sm-7"><h4>21 March 2050</h4></div>

						<div class="clearfix"></div>
						<div class="bot-border"></div>

						<div class="col-sm-5 col-xs-6 tital "><h4>E-mail</h4></div>
						<div class="col-sm-7"><h4>{{e_mail}}</h4></div>

						<div class="clearfix"></div>
						<div class="bot-border"></div>

						<div class="col-sm-5 col-xs-6 tital "><h4>Country:</h4></div>
						<div class="col-sm-7"><h4>Unknown</h4></div>

						<div class="clearfix"></div>
						<div class="bot-border"></div>

						<div class="col-sm-5 col-xs-6 tital "><h4>Gender:</h4></div>
						<div class="col-sm-7"><h4>Unknown</h4></div>

						<div class="clearfix"></div>
						<div class="bot-border"></div>


				 {% if userMap %}
						<table id="glorious-table" class="table table-bordered table-responsive">

                <thead>
                    <tr>

                        <th>Order</th>
                        <th>Info</th>
                        <th>Address</th>
                        <th>Lat</th>
                        <th>Lng</th>
                    </tr>
                </thead>

                <tbody id="glorious-table-body">
                {% for userLocation in userMap %} 
                    <tr>
						<td>{{ userLocation.locationId }}</td>

                        <td>{{ userLocation.lat }}</td>
                        <td>{{ userLocation.lng }}</td>
                    </tr>
                 {% endfor %} 
                </tbody>
                {% endif %}
                    <script async defer
   
    <script>
    	 var locations = {{markerLocations|tojson}}
    	 var newLocations = []
		var labelIndex = 0;
      function initMap() {

        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 3,
          center: {lat: 40.024, lng: 30.887},
            styles: [{"featureType":"administrative","elementType":"all","stylers":[{"saturation":"-100"}]},{"featureType":"administrative.province","elementType":"all","stylers":[{"visibility":"off"}]},{"featureType":"landscape","elementType":"all","stylers":[{"saturation":-100},{"lightness":65},{"visibility":"on"}]},{"featureType":"poi","elementType":"all","stylers":[{"saturation":-100},{"lightness":"50"},{"visibility":"simplified"}]},{"featureType":"road","elementType":"all","stylers":[{"saturation":"-100"}]},{"featureType":"road.highway","elementType":"all","stylers":[{"visibility":"simplified"}]},{"featureType":"road.arterial","elementType":"all","stylers":[{"lightness":"30"}]},{"featureType":"road.local","elementType":"all","stylers":[{"lightness":"40"}]},{"featureType":"transit","elementType":"all","stylers":[{"saturation":-100},{"visibility":"simplified"}]},{"featureType":"water","elementType":"geometry","stylers":[{"hue":"#ffff00"},{"lightness":-25},{"saturation":-97}]},{"featureType":"water","elementType":"labels","stylers":[{"lightness":-25},{"saturation":-100}]}]
        });

        // Create an array of alphabetical characters used to label the markers.

        // Add some markers to the map.
        // Note: The code uses the JavaScript Array.prototype.map() method to
        // create an array of markers based on a given "locations" array.
        // The map() method here has nothing to do with the Google Maps API.
        var markers = locations.map(function(location, i) {
          return new google.maps.Marker({
            position: location,
            label: locations[i % locations.length].label
          });
          
        });
 
		

        // Add a marker clusterer to manage the markers.
        var markerCluster = new MarkerClusterer(map, markers,
            {imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});
            
           google.maps.event.addListener(map, 'dblclick', function(event) {
             
          locations.push({lat: event.latLng.lat(),lng: event.latLng.lng()});
           
          addMarker(event.latLng, map);
          	
             function addMarker(location, map) {
        markers = locations.map(function(location, i) {
          return new google.maps.Marker({
            position: location
          });
        });
       
        markerCluster = new MarkerClusterer(map, markers,
            {imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});
        $('#squareSigninModal').modal('show');
        
        
        $(function() {
    $('#share').bind('click', function(form) {
    var locationLabel = document.getElementById("label").value;
    var locationInfo = document.getElementById("info").value;
    newLocations.push({lat: event.latLng.lat(),lng: event.latLng.lng(),label: locationLabel,info: locationInfo});
      $.ajax({
    url: "/userPage/getLocations",
    type: "POST",
    data: JSON.stringify(newLocations),
    contentType: "application/json; charset=utf-8",
    success: function(dat) { console.log(dat); }
});
    });
 });
      }
        });
      }
     
	
     

      google.maps.event.addDomListener(window, 'load', initialize);
    </script>
    <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB9fvYCoVIga4fQ-mHNtf4dv4jHbCjCJKw&callback=initMap"></script>
    
    <script type=text/javascript>
  
</script>

            </table>
            <form role="form" method="post" action='/userPage/map' >
						<div class="form-group">
							<label for="locationInfo">Location Information</label>
							<input class="form-control" name="locationInfo"
								placeholder="location info" required>
						</div>
						<div class="form-group">
							<label for="address">Address</label>
							 <input  class="form-control" name="address"
								placeholder="address" required>
						</div>
						<div class="form-group">
							<label for="lat">Lat</label>
							<input class="form-control" name="lat"
								placeholder="lat" required>
						</div>
						<div class="form-group">
							<label for="lng">Lng</label>
							 <input class="form-control" name="lng"
								placeholder="lng" required>
						</div>
						<button type="submit" class="btn btn-primary">Add Location</button>
					</form>

						<!-- /.box-body -->
					</div>
					<!-- /.box -->

				</div>


			</div>
		</div>
	</div>

</div>


{% endblock %}



